# copy url under the cusor to the clipboard
keymap  yy EXTERN_LINK '(echo -n %s | xsel -b)'

# strip the google redirect from the url under the cursor and open with mpv
keymap  mn EXTERN_LINK "(mpv --no-terminal $(echo -n %s | grep -oP '(?=https://www.youtube.com)[^&]*(?=&)' | sed 's/%3Fv%3D/?v=/') &)"

# strip the google redirect from the url under the cursor and add to a task-spooler queue to open fullscreen on the second display with mpv
keymap  m, EXTERN_LINK "(tsp mpv --fs --screen=1 $(echo -n %s | grep -oP '(?=https://www.youtube.com)[^&]*(?=&)' | sed 's/%3Fv%3D/?v=/') &)"

# strip the google redirect from the url under the cursor and send the url to mpd
keymap  mk EXTERN_LINK "(pinch -i $(echo -n %s | grep -oP '(?=https://www.youtube.com)[^&]*(?=&)' | sed 's/%3Fv%3D/?v=/') 1>/dev/null &)"

# readability mode
keymap ,-. COMMAND "READ_SHELL 'python3 -m readability.readability -u $W3M_URL 2> /dev/null 1> /tmp/readability.html' ; LOAD /tmp/readability.html"

# toggle images
keymap i COMMAND "SET_OPTION display_image=toggle ; RELOAD" 

# toggle borders
keymap ,-t COMMAND "SET_OPTION display_borders=toggle ; RESHAPE"

# toggle line numbers
keymap ,-l COMMAND "SET_OPTION display_link_number=toggle ; RESHAPE"

# surfraw prompt
keymap xs COMMAND  "READ_SHELL ~/.w3m/cgi-bin/fzf_surfraw.cgi ; GOTO /usr/lib/w3m/cgi-bin/goto_clipboard_primary.cgi"
